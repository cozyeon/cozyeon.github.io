---
layout: post
title: "[통계101 데이터분석] Part 8,9"
date: 2023-10-08
categories: "데이터와통계학"
---

# 8장. 통계 모형화

## **8-1. 선형회귀 원리의 확장**

### 선형회귀는 다양한 해석 방법의 기초
- 선형회귀: x를 설명변수, y를 반응변수로 하여 데이터에 1차식 y=a+bx를 적용하고 설명번수와 반응변수 사이의 관계를 밝히는 것   
-> but 실제 데이터 해석에서는 설명변수가 여러 개, 반응 변수가 범주형 번수인 경우 등 회귀모형 항상 적절 X
![from_linear](/assets/img/from_linear.jpg)


#### # 확장 방향성
1. 설명변수의 개수를 늘리거나 유형 변경하기
2. 반응변수의 유형 변경하기
3. 회귀모형의 형태 변경하기

### 다중회귀
설명변수가 여러 개인 것

#### # 다중선형회귀모형
설명변수가 k개인 가장 단순한 모형    
![multi_linear](/assets/img/multi_linear.jpg)

- k+1 개의 파라미터를 가짐.
- a: 절편
- b<sub>i</sub>: 편회귀계수, x<sub>i</sub> 축에 대한 기울기
- 설명변수가 2개일 때의 회귀모형 -> 회귀평면

#### # 다중회귀 결과를 읽는 방법
![multi_linear_result](/assets/img/multi_linear_result)
- 편회귀계수는 모두 유의미
- R<sup>2</sup> : 데이터에 잘 들어맞는지를 나타냄
- F 통계량에서 얻은 p값 : 편회귀계수가 모두 0인 모형 (R<sup>2</sup>=0) 을 귀무가설로 하여 유의성 조사   
-> p<0.05 이므로 회귀모형의 설명력에 유의성이 있다고 판단.

### 편회귀계수

#### # 표준화편회귀계수   
: 회귀분석을 시행하기 전에 각각의 설명변수를 평균 0, 표준편차 1로 변환한 다음, 회귀분석을 시행하여 구한 회귀계수 
- 각 설명변수가 표준편차 단위에서 1 늘었을 때 반응변수의 증감을 나타냄. 
- 회귀모형이 얼마나 잘 들어맞는지나 편회귀계수의 p값 등은 원래 회귀결과와 같음.

#### # why 표준화편회귀계수 이용??

- 회귀분석에서 구한 편회귀계수는 설명변수의 데이터 퍼짐 정도나 단위에 따라 크게 달라지기 때문에 편회귀계수끼리 비교할 수는 없음.   

> ex) [몸무게] = a + b<sub>1</sub> X [키] + b<sub>2</sub> X [ 1일 걸음 수 ] + 입실론   
> - b<sub>1</sub> : 키가 1cm 커질 때의 몸무게 증감   
> - b<sub>2</sub> : 1일 걸음 수가 1보 늘었을 때의 몸무게 증감   
> - 키 1cm가 하루에 1걸음 보다 훨씬 더 영향이 큼을 직관적으로 알 수 있음.   
> => 즉, 일반적인 편회귀계수끼리 그대로 비교할 수 없다.

![s_p_r_c](/assets/img/s_p_r_c.jpg)

#### # 편회귀계수의 해석
- 설명변수 사이에 상관이 있는 경우 x<sub>i</sub> 외의 설명변수를 고정한 채 x<sub>i</sub>를 독립적으로 움직일 수 없음.
- 상관계수가 1에 가까울 때, 다중공선성을 의심해 봐야 함.

### 범주형 변수를 설명변수로
범주형을 회귀분석의 설명변수로 이용할 때 0또는 1과 같은 **가변수**를 이용
- 범주 2개 - 0 또는 1   
-> 기울기인 b가 두 범주의 차이를 나타냄.
- 범주 3개 이상 - 0 또는 1을 (범주개수 -1)개 준비    
 ex) 범주 4개 - (x1=0 x2=0 x3=0), (x1=1 x2=0 x3=0), (x1=0 x2=1 x3=0), (x1=0 x2=0 x3=1)   
 -> b가 (x1=0 x2=0 x3=0)에 해당하는 범주를 기준으로 그 밖의 범주들이 어느 정도 다른지 나타냄.    
 ![dummy_variable](/assets/img/dummy_variable.jpg)

 ### 공분산분석
 : 일반적인 분산분석에 사용하는 데이터와 함께 양적 변수 데이터가 있는 경우에 후보가 되는 방법

 - 공변량(covariate): 새로 추가한 양적 변수   

ex) 회사원의 연소득 y가 회사 x<sub>i</sub>의 차이에 따라 달라지는지 조사   
![ANCOVA](/assets/img/ANCOVA.jpg)

?

### 고차원 데이터 문제
- 차원의 저주: 차원이 늘어날수록 파라미터 추정에 필요한 데이터 양이 폭발적으로 증가함.
- 차원이 증가할수록 다중공선성 문제가 일어나기 쉬움. -> 모형의 추정 정밀도가 떨어짐.

### 다중공선성
- 설명변수가 여러 개인 다중회귀에서 설명변수 사이에 강한 상관이 있는 경우 -> 다중공선성이 있다. 
- 다중공선성이 있다면 회귀계수의 추정오차가 커짐. -> 추정값의 신뢰성이 떨어짐.

#### # 다중공선성 측정
분산팽창인수 VIF(variance inflation factor) 계산      
![VIF](/assets/img/VIF.jpg)   
-> R<sub>i</sub><sup>2</sup> : 하나의 설명변수를 반응변수로 설정하고, 나머지 설명변수를 이용하여 회귀를 시행한 결정계수    
- VIF>10 : 2개 사이의 상관이 아주 강함.    
-> 서로 상관이 있는 2개 변수 중 하나를 없애거나, 차원 축소 방법을 이용하여 설명변수의 개수를 줄이는 것이 좋음. 


## **8-2. 회귀모형의 형태 바꾸기**

### 상호작용
: 설명변수 간의 상승효과
- x<sub>i</sub> 가 1 증가했을 때의 y 증가 방식이 또 다른 설명변수의 영향을 받을 수도 있음. 
- 선형회귀모형 안에서 곱셈 c x<sub>i</sub> x<sub>j</sub> 로 도입 가능.   
![cxixj](/assets/img/cxixj.jpg)

#### # 상호작용항의 문제점
- 상호작용을 넣으면 해석이 어려워짐.
- 설명변수의 개수가 늘면 상호작용항의 수가 폭발적으로 늘어남.
- 상호작용의 형태는 다양한데도 곱셈으로만 나타냄.
- 설명변수와 상호작용항의 다중공선성 문제가 있음.

#### # 상호작용항을 적용하면 좋은 경우
- 상호작용이 있다는 것이 선행 연구에서 밝혀지거나 기대되는 때
- 데이터에 분명한 상호작용이 있을 때
- 상호작용 유무에 관심이 있을 때

### 이원배치 분산분석
다원배치 분산분석: 여러 개의 요인을 동시에 고려하는 분산분석

 ## **8-3. 일반화선형모형의 개념**
 ## **8-4. 통계 모형의 평가와 비교**


